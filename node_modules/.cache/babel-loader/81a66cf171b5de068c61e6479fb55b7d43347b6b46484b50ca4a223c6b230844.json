{"ast":null,"code":"import _regeneratorRuntime from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _createClass from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _classCallCheck from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _inherits from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport CustomError from '../errors/CustomError.js';\nimport { urlParamsToObject } from '../oidc/util/urlParams.js';\nvar EmailVerifyCallbackError = /*#__PURE__*/function (_CustomError) {\n  _inherits(EmailVerifyCallbackError, _CustomError);\n  var _super = _createSuper(EmailVerifyCallbackError);\n  function EmailVerifyCallbackError(state, otp) {\n    var _this;\n    _classCallCheck(this, EmailVerifyCallbackError);\n    _this = _super.call(this, \"Enter the OTP code in the originating client: \".concat(otp));\n    _this.name = 'EmailVerifyCallbackError';\n    _this.state = state;\n    _this.otp = otp;\n    return _this;\n  }\n  return _createClass(EmailVerifyCallbackError);\n}(CustomError);\nfunction isEmailVerifyCallbackError(error) {\n  return error.name === 'EmailVerifyCallbackError';\n}\nfunction isEmailVerifyCallback(urlPath) {\n  return /(otp=)/i.test(urlPath) && /(state=)/i.test(urlPath);\n}\nfunction parseEmailVerifyCallback(urlPath) {\n  return urlParamsToObject(urlPath);\n}\nfunction handleEmailVerifyCallback(_x, _x2) {\n  return _handleEmailVerifyCallback.apply(this, arguments);\n}\nfunction _handleEmailVerifyCallback() {\n  _handleEmailVerifyCallback = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(authClient, search) {\n    var _parseEmailVerifyCall, state, otp;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          if (!isEmailVerifyCallback(search)) {\n            _context.next = 9;\n            break;\n          }\n          _parseEmailVerifyCall = parseEmailVerifyCallback(search), state = _parseEmailVerifyCall.state, otp = _parseEmailVerifyCall.otp;\n          if (!authClient.idx.canProceed({\n            state: state\n          })) {\n            _context.next = 8;\n            break;\n          }\n          _context.next = 5;\n          return authClient.idx.proceed({\n            state: state,\n            otp: otp\n          });\n        case 5:\n          return _context.abrupt(\"return\", _context.sent);\n        case 8:\n          throw new EmailVerifyCallbackError(state, otp);\n        case 9:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return _handleEmailVerifyCallback.apply(this, arguments);\n}\nexport { EmailVerifyCallbackError, handleEmailVerifyCallback, isEmailVerifyCallback, isEmailVerifyCallbackError, parseEmailVerifyCallback };","map":{"version":3,"names":["EmailVerifyCallbackError","_CustomError","_inherits","_super","_createSuper","state","otp","_this","_classCallCheck","call","concat","name","_createClass","CustomError","isEmailVerifyCallbackError","error","isEmailVerifyCallback","urlPath","test","parseEmailVerifyCallback","urlParamsToObject","handleEmailVerifyCallback","_x","_x2","_handleEmailVerifyCallback","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","authClient","search","_parseEmailVerifyCall","wrap","_callee$","_context","prev","next","idx","canProceed","proceed","abrupt","sent","stop"],"sources":["/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@okta/lib/idx/emailVerify.ts"],"sourcesContent":["\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { OktaAuthIdxInterface } from './types';\n\nimport CustomError from '../errors/CustomError';\nimport { urlParamsToObject  } from '../oidc/util/urlParams';\nimport { EmailVerifyCallbackResponse } from './types/api';\n\nexport class EmailVerifyCallbackError extends CustomError {\n  state: string;\n  otp: string;\n\n  constructor(state: string, otp: string) {\n    super(`Enter the OTP code in the originating client: ${otp}`);\n    this.name = 'EmailVerifyCallbackError';\n    this.state = state;\n    this.otp = otp;\n  }\n}\n\nexport function isEmailVerifyCallbackError(error: Error) {\n  return (error.name === 'EmailVerifyCallbackError');\n}\n\n// Check if state && otp have been passed back in the url\nexport function isEmailVerifyCallback (urlPath: string): boolean {\n  return /(otp=)/i.test(urlPath) && /(state=)/i.test(urlPath);\n}\n\n// Parse state and otp from a urlPath (should be either a search or fragment from the URL)\nexport function parseEmailVerifyCallback(urlPath: string): EmailVerifyCallbackResponse {\n  return urlParamsToObject(urlPath) as EmailVerifyCallbackResponse;\n}\n\nexport async function handleEmailVerifyCallback(authClient: OktaAuthIdxInterface, search: string) {\n  if (isEmailVerifyCallback(search)) {\n    const { state, otp } = parseEmailVerifyCallback(search);\n    if (authClient.idx.canProceed({ state })) {\n      // same browser / device\n      return await authClient.idx.proceed({ state, otp });\n    } else {\n      // different browser or device\n      throw new EmailVerifyCallbackError(state, otp);\n    }\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;IAmBaA,wBAAyB,0BAAAC,YAAA;EAAAC,SAAA,CAAAF,wBAAA,EAAAC,YAAA;EAAA,IAAAE,MAAA,GAAAC,YAAA,CAAAJ,wBAAA;EAIpC,SAAAA,yBAAYK,KAAa,EAAEC,GAAW;IAAA,IAAAC,KAAA;IAAAC,eAAA,OAAAR,wBAAA;IACpCO,KAAA,GAAAJ,MAAA,CAAAM,IAAA,wDAAAC,MAAA,CAAuDJ,GAAG;IAC1DC,KAAA,CAAKI,IAAI,GAAG,0BAA0B;IACtCJ,KAAA,CAAKF,KAAK,GAAGA,KAAK;IAClBE,KAAA,CAAKD,GAAG,GAAGA,GAAG;IAAC,OAAAC,KAAA;EAChB;EAAA,OAAAK,YAAA,CAAAZ,wBAAA;AAAA,EAT2Ca,WAAW;AAYnD,SAAUC,0BAA0BA,CAACC,KAAY;EACrD,OAAQA,KAAK,CAACJ,IAAI,KAAK,0BAA0B;AACnD;AAGM,SAAUK,qBAAqBA,CAAEC,OAAe;EACpD,OAAO,SAAS,CAACC,IAAI,CAACD,OAAO,CAAC,IAAI,WAAW,CAACC,IAAI,CAACD,OAAO,CAAC;AAC7D;AAGM,SAAUE,wBAAwBA,CAACF,OAAe;EACtD,OAAOG,iBAAiB,CAACH,OAAO,CAAgC;AAClE;AAAC,SAEqBI,yBAAyBA,CAAAC,EAAA,EAAAC,GAAA;EAAA,OAAAC,0BAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAAA,SAAAF,2BAAA;EAAAA,0BAAA,GAAAG,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAxC,SAAAC,QAAyCC,UAAgC,EAAEC,MAAc;IAAA,IAAAC,qBAAA,EAAA5B,KAAA,EAAAC,GAAA;IAAA,OAAAsB,mBAAA,GAAAM,IAAA,UAAAC,SAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;QAAA;UAAA,KAC1FtB,qBAAqB,CAACgB,MAAM,CAAC;YAAAI,QAAA,CAAAE,IAAA;YAAA;UAAA;UAAAL,qBAAA,GACRd,wBAAwB,CAACa,MAAM,CAAC,EAA/C3B,KAAK,GAAA4B,qBAAA,CAAL5B,KAAK,EAAEC,GAAG,GAAA2B,qBAAA,CAAH3B,GAAG;UAAA,KACdyB,UAAU,CAACQ,GAAG,CAACC,UAAU,CAAC;YAAEnC,KAAK,EAALA;UAAO,EAAC;YAAA+B,QAAA,CAAAE,IAAA;YAAA;UAAA;UAAAF,QAAA,CAAAE,IAAA;UAAA,OAEzBP,UAAU,CAACQ,GAAG,CAACE,OAAO,CAAC;YAAEpC,KAAK,EAALA,KAAK;YAAEC,GAAG,EAAHA;UAAG,CAAE,CAAC;QAAA;UAAA,OAAA8B,QAAA,CAAAM,MAAA,WAAAN,QAAA,CAAAO,IAAA;QAAA;UAAA,MAG7C,IAAI3C,wBAAwB,CAACK,KAAK,EAAEC,GAAG,CAAC;QAAA;QAAA;UAAA,OAAA8B,QAAA,CAAAQ,IAAA;MAAA;IAAA,GAAAd,OAAA;EAAA,CAGpD;EAAA,OAAAN,0BAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}