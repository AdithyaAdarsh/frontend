{"ast":null,"code":"var _jsxFileName = \"/Users/aadar00/Library/CloudStorage/OneDrive-BlackhawkNetwork,Inc/Documents/image-moderation-app/frontend/src/LoginCallback.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LoginCallback = () => {\n  _s();\n  const navigate = useNavigate();\n  useEffect(() => {\n    var _oktaTokenData$access, _oktaTokenData$idToke, _oktaTokenData$idToke2;\n    // Retrieve the Okta token storage from local storage\n    const oktaTokenStorage = localStorage.getItem('okta-token-storage');\n    if (!oktaTokenStorage) {\n      console.error('Okta token storage not found in local storage');\n      // Handle this error case, e.g., display a message to the user\n      return;\n    }\n    const oktaTokenData = JSON.parse(oktaTokenStorage);\n    if (!(oktaTokenData !== null && oktaTokenData !== void 0 && (_oktaTokenData$access = oktaTokenData.accessToken) !== null && _oktaTokenData$access !== void 0 && _oktaTokenData$access.value)) {\n      console.error('Access token not found in Okta token storage');\n      // Handle this error case, e.g., display a message to the user\n      return;\n    }\n\n    // Check if the token storage indicates a successful login\n    if (oktaTokenData !== null && oktaTokenData !== void 0 && (_oktaTokenData$idToke = oktaTokenData.idToken) !== null && _oktaTokenData$idToke !== void 0 && (_oktaTokenData$idToke2 = _oktaTokenData$idToke.claims) !== null && _oktaTokenData$idToke2 !== void 0 && _oktaTokenData$idToke2.sub) {\n      const accessToken = oktaTokenData.accessToken.value;\n      console.log('Retrieved access token:', accessToken);\n\n      // Send the access token to your server's /login endpoint\n      axios.post('http://localhost:5000/login', {\n        access_token: accessToken\n      }).then(response => {\n        if (response.data.access_token) {\n          // Store the token securely (localStorage or sessionStorage)\n          localStorage.setItem('token', response.data.access_token);\n\n          // Redirect to the /customer_service route\n          navigate('/customer_service');\n\n          // You can now navigate to the protected route if needed\n          // Example: navigate('/customer_service');\n        } else {\n          console.error('Access token not received');\n          // Handle this error case, e.g., display a message to the user\n        }\n      }).catch(error => {\n        console.error('Error sending token to server:', error);\n        // Handle this error case, e.g., display a message to the user\n      });\n    } else {\n      console.error('Login not successful');\n      // Handle this error case, e.g., display a message to the user\n    }\n  }, [navigate]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Logging in...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 10\n  }, this);\n};\n_s(LoginCallback, \"0pNeyzXk/ByIxyERsdaIrG6js9s=\", false, function () {\n  return [useNavigate];\n});\n_c = LoginCallback;\nexport default LoginCallback;\nvar _c;\n$RefreshReg$(_c, \"LoginCallback\");","map":{"version":3,"names":["React","useEffect","axios","useNavigate","jsxDEV","_jsxDEV","LoginCallback","_s","navigate","_oktaTokenData$access","_oktaTokenData$idToke","_oktaTokenData$idToke2","oktaTokenStorage","localStorage","getItem","console","error","oktaTokenData","JSON","parse","accessToken","value","idToken","claims","sub","log","post","access_token","then","response","data","setItem","catch","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/aadar00/Library/CloudStorage/OneDrive-BlackhawkNetwork,Inc/Documents/image-moderation-app/frontend/src/LoginCallback.js"],"sourcesContent":["import React, { useEffect } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\n\nconst LoginCallback = () => {\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    // Retrieve the Okta token storage from local storage\n    const oktaTokenStorage = localStorage.getItem('okta-token-storage');\n    \n    if (!oktaTokenStorage) {\n      console.error('Okta token storage not found in local storage');\n      // Handle this error case, e.g., display a message to the user\n      return;\n    }\n\n    const oktaTokenData = JSON.parse(oktaTokenStorage);\n\n    if (!oktaTokenData?.accessToken?.value) {\n      console.error('Access token not found in Okta token storage');\n      // Handle this error case, e.g., display a message to the user\n      return;\n    }\n\n    // Check if the token storage indicates a successful login\n    if (oktaTokenData?.idToken?.claims?.sub) {\n      const accessToken = oktaTokenData.accessToken.value;\n      console.log('Retrieved access token:', accessToken);\n\n      // Send the access token to your server's /login endpoint\n      axios\n        .post('http://localhost:5000/login', { access_token: accessToken })\n        .then((response) => {\n          if (response.data.access_token) {\n            // Store the token securely (localStorage or sessionStorage)\n            localStorage.setItem('token', response.data.access_token);\n\n            // Redirect to the /customer_service route\n            navigate('/customer_service');\n\n            // You can now navigate to the protected route if needed\n            // Example: navigate('/customer_service');\n          } else {\n            console.error('Access token not received');\n            // Handle this error case, e.g., display a message to the user\n          }\n        })\n        .catch((error) => {\n          console.error('Error sending token to server:', error);\n          // Handle this error case, e.g., display a message to the user\n        });\n    } else {\n      console.error('Login not successful');\n      // Handle this error case, e.g., display a message to the user\n    }\n  }, [navigate]);\n\n  return <div>Logging in...</div>;\n};\n\nexport default LoginCallback;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,WAAW,QAAQ,kBAAkB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE/C,MAAMC,aAAa,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC1B,MAAMC,QAAQ,GAAGL,WAAW,CAAC,CAAC;EAE9BF,SAAS,CAAC,MAAM;IAAA,IAAAQ,qBAAA,EAAAC,qBAAA,EAAAC,sBAAA;IACd;IACA,MAAMC,gBAAgB,GAAGC,YAAY,CAACC,OAAO,CAAC,oBAAoB,CAAC;IAEnE,IAAI,CAACF,gBAAgB,EAAE;MACrBG,OAAO,CAACC,KAAK,CAAC,+CAA+C,CAAC;MAC9D;MACA;IACF;IAEA,MAAMC,aAAa,GAAGC,IAAI,CAACC,KAAK,CAACP,gBAAgB,CAAC;IAElD,IAAI,EAACK,aAAa,aAAbA,aAAa,gBAAAR,qBAAA,GAAbQ,aAAa,CAAEG,WAAW,cAAAX,qBAAA,eAA1BA,qBAAA,CAA4BY,KAAK,GAAE;MACtCN,OAAO,CAACC,KAAK,CAAC,8CAA8C,CAAC;MAC7D;MACA;IACF;;IAEA;IACA,IAAIC,aAAa,aAAbA,aAAa,gBAAAP,qBAAA,GAAbO,aAAa,CAAEK,OAAO,cAAAZ,qBAAA,gBAAAC,sBAAA,GAAtBD,qBAAA,CAAwBa,MAAM,cAAAZ,sBAAA,eAA9BA,sBAAA,CAAgCa,GAAG,EAAE;MACvC,MAAMJ,WAAW,GAAGH,aAAa,CAACG,WAAW,CAACC,KAAK;MACnDN,OAAO,CAACU,GAAG,CAAC,yBAAyB,EAAEL,WAAW,CAAC;;MAEnD;MACAlB,KAAK,CACFwB,IAAI,CAAC,6BAA6B,EAAE;QAAEC,YAAY,EAAEP;MAAY,CAAC,CAAC,CAClEQ,IAAI,CAAEC,QAAQ,IAAK;QAClB,IAAIA,QAAQ,CAACC,IAAI,CAACH,YAAY,EAAE;UAC9B;UACAd,YAAY,CAACkB,OAAO,CAAC,OAAO,EAAEF,QAAQ,CAACC,IAAI,CAACH,YAAY,CAAC;;UAEzD;UACAnB,QAAQ,CAAC,mBAAmB,CAAC;;UAE7B;UACA;QACF,CAAC,MAAM;UACLO,OAAO,CAACC,KAAK,CAAC,2BAA2B,CAAC;UAC1C;QACF;MACF,CAAC,CAAC,CACDgB,KAAK,CAAEhB,KAAK,IAAK;QAChBD,OAAO,CAACC,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;QACtD;MACF,CAAC,CAAC;IACN,CAAC,MAAM;MACLD,OAAO,CAACC,KAAK,CAAC,sBAAsB,CAAC;MACrC;IACF;EACF,CAAC,EAAE,CAACR,QAAQ,CAAC,CAAC;EAEd,oBAAOH,OAAA;IAAA4B,QAAA,EAAK;EAAa;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAK,CAAC;AACjC,CAAC;AAAC9B,EAAA,CAvDID,aAAa;EAAA,QACAH,WAAW;AAAA;AAAAmC,EAAA,GADxBhC,aAAa;AAyDnB,eAAeA,aAAa;AAAC,IAAAgC,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}