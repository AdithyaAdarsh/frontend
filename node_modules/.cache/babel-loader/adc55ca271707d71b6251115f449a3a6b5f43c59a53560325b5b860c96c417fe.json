{"ast":null,"code":"import _regeneratorRuntime from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _classCallCheck from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { parseOAuthResponseFromUrl } from '../oidc/parseFromUrl.js';\nimport { AuthStateManager } from './AuthStateManager.js';\nimport { ServiceManager } from './ServiceManager/browser.js';\nfunction mixinCore(Base) {\n  return /*#__PURE__*/function (_Base) {\n    _inherits(OktaAuthCore, _Base);\n    var _super = _createSuper(OktaAuthCore);\n    function OktaAuthCore() {\n      var _this;\n      _classCallCheck(this, OktaAuthCore);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _super.call.apply(_super, [this].concat(args));\n      _this.authStateManager = new AuthStateManager(_assertThisInitialized(_this));\n      _this.serviceManager = new ServiceManager(_assertThisInitialized(_this), _this.options.services);\n      return _this;\n    }\n    _createClass(OktaAuthCore, [{\n      key: \"start\",\n      value: function () {\n        var _start = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.serviceManager.start();\n              case 2:\n                this.tokenManager.start();\n                if (this.token.isLoginRedirect()) {\n                  _context.next = 6;\n                  break;\n                }\n                _context.next = 6;\n                return this.authStateManager.updateAuthState();\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee, this);\n        }));\n        function start() {\n          return _start.apply(this, arguments);\n        }\n        return start;\n      }()\n    }, {\n      key: \"stop\",\n      value: function () {\n        var _stop = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n          return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n            while (1) switch (_context2.prev = _context2.next) {\n              case 0:\n                this.tokenManager.stop();\n                _context2.next = 3;\n                return this.serviceManager.stop();\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }, _callee2, this);\n        }));\n        function stop() {\n          return _stop.apply(this, arguments);\n        }\n        return stop;\n      }()\n    }, {\n      key: \"handleRedirect\",\n      value: function () {\n        var _handleRedirect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(originalUri) {\n          return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n            while (1) switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.handleLoginRedirect(undefined, originalUri);\n              case 2:\n              case \"end\":\n                return _context3.stop();\n            }\n          }, _callee3, this);\n        }));\n        function handleRedirect(_x) {\n          return _handleRedirect.apply(this, arguments);\n        }\n        return handleRedirect;\n      }()\n    }, {\n      key: \"handleLoginRedirect\",\n      value: function () {\n        var _handleLoginRedirect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(tokens, originalUri) {\n          var state, oAuthResponse, restoreOriginalUri;\n          return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n            while (1) switch (_context4.prev = _context4.next) {\n              case 0:\n                state = this.options.state;\n                if (!tokens) {\n                  _context4.next = 6;\n                  break;\n                }\n                this.tokenManager.setTokens(tokens);\n                originalUri = originalUri || this.getOriginalUri(this.options.state);\n                _context4.next = 25;\n                break;\n              case 6:\n                if (!this.isLoginRedirect()) {\n                  _context4.next = 24;\n                  break;\n                }\n                _context4.prev = 7;\n                _context4.next = 10;\n                return parseOAuthResponseFromUrl(this, {});\n              case 10:\n                oAuthResponse = _context4.sent;\n                state = oAuthResponse.state;\n                originalUri = originalUri || this.getOriginalUri(state);\n                _context4.next = 15;\n                return this.storeTokensFromRedirect();\n              case 15:\n                _context4.next = 22;\n                break;\n              case 17:\n                _context4.prev = 17;\n                _context4.t0 = _context4[\"catch\"](7);\n                _context4.next = 21;\n                return this.authStateManager.updateAuthState();\n              case 21:\n                throw _context4.t0;\n              case 22:\n                _context4.next = 25;\n                break;\n              case 24:\n                return _context4.abrupt(\"return\");\n              case 25:\n                _context4.next = 27;\n                return this.authStateManager.updateAuthState();\n              case 27:\n                this.removeOriginalUri(state);\n                restoreOriginalUri = this.options.restoreOriginalUri;\n                if (!restoreOriginalUri) {\n                  _context4.next = 34;\n                  break;\n                }\n                _context4.next = 32;\n                return restoreOriginalUri(this, originalUri);\n              case 32:\n                _context4.next = 35;\n                break;\n              case 34:\n                if (originalUri) {\n                  window.location.replace(originalUri);\n                }\n              case 35:\n              case \"end\":\n                return _context4.stop();\n            }\n          }, _callee4, this, [[7, 17]]);\n        }));\n        function handleLoginRedirect(_x2, _x3) {\n          return _handleLoginRedirect.apply(this, arguments);\n        }\n        return handleLoginRedirect;\n      }()\n    }]);\n    return OktaAuthCore;\n  }(Base);\n}\nexport { mixinCore };","map":{"version":3,"names":["mixinCore","Base","_Base","_inherits","OktaAuthCore","_super","_createSuper","_this","_classCallCheck","_len","arguments","length","args","Array","_key","call","apply","concat","authStateManager","AuthStateManager","_assertThisInitialized","serviceManager","ServiceManager","options","services","_createClass","key","value","_start","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","start","tokenManager","token","isLoginRedirect","updateAuthState","stop","_stop","_callee2","_callee2$","_context2","_handleRedirect","_callee3","originalUri","_callee3$","_context3","handleLoginRedirect","undefined","handleRedirect","_x","_handleLoginRedirect","_callee4","tokens","state","oAuthResponse","restoreOriginalUri","_callee4$","_context4","setTokens","getOriginalUri","parseOAuthResponseFromUrl","sent","storeTokensFromRedirect","t0","abrupt","removeOriginalUri","window","location","replace","_x2","_x3"],"sources":["/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@okta/lib/core/mixin.ts"],"sourcesContent":["import { parseOAuthResponseFromUrl } from '../oidc/parseFromUrl';\nimport { OktaAuthConstructor } from '../base/types';\nimport {\n  OAuthStorageManagerInterface,\n  OAuthTransactionMeta,\n  OktaAuthOAuthInterface,\n  PKCETransactionMeta,\n  Tokens,\n  TransactionManagerInterface,\n} from '../oidc/types';\nimport { AuthStateManager } from './AuthStateManager';\nimport { ServiceManager } from './ServiceManager';\nimport { OktaAuthCoreInterface, OktaAuthCoreOptions } from './types';\n\nexport function mixinCore\n<\n  M extends OAuthTransactionMeta = PKCETransactionMeta,\n  S extends OAuthStorageManagerInterface<M> = OAuthStorageManagerInterface<M>,\n  O extends OktaAuthCoreOptions = OktaAuthCoreOptions,\n  TM extends TransactionManagerInterface = TransactionManagerInterface,\n  TBase extends OktaAuthConstructor<OktaAuthOAuthInterface<M, S, O, TM>>\n    = OktaAuthConstructor<OktaAuthOAuthInterface<M, S, O, TM>>\n>\n(Base: TBase): TBase & OktaAuthConstructor<OktaAuthCoreInterface<M, S, O, TM>>\n{\n  return class OktaAuthCore extends Base implements OktaAuthCoreInterface<M, S, O, TM>\n  {\n    authStateManager: AuthStateManager<M, S, O>;\n    serviceManager: ServiceManager<M, S, O>;\n    \n    constructor(...args: any[]) {\n      super(...args);\n\n      // AuthStateManager\n      this.authStateManager = new AuthStateManager<M, S, O>(this);\n\n      // ServiceManager\n      this.serviceManager = new ServiceManager<M, S, O>(this, this.options.services);\n    }\n\n    async start() {\n      await this.serviceManager.start();\n      // TODO: review tokenManager.start\n      this.tokenManager.start();\n      if (!this.token.isLoginRedirect()) {\n        await this.authStateManager.updateAuthState();\n      }\n    }\n  \n    async stop() {\n      // TODO: review tokenManager.stop\n      this.tokenManager.stop();\n      await this.serviceManager.stop();\n    }\n\n    async handleRedirect(originalUri?: string): Promise<void> {\n      await this.handleLoginRedirect(undefined, originalUri);\n    }\n\n    // eslint-disable-next-line complexity\n    async handleLoginRedirect(tokens?: Tokens, originalUri?: string): Promise<void> {\n      let state = this.options.state;\n  \n      // Store tokens and update AuthState by the emitted events\n      if (tokens) {\n        this.tokenManager.setTokens(tokens);\n        originalUri = originalUri || this.getOriginalUri(this.options.state);\n      } else if (this.isLoginRedirect()) {\n        try {\n          // For redirect flow, get state from the URL and use it to retrieve the originalUri\n          const oAuthResponse = await parseOAuthResponseFromUrl(this, {});\n          state = oAuthResponse.state;\n          originalUri = originalUri || this.getOriginalUri(state);\n          await this.storeTokensFromRedirect();\n        } catch(e) {\n          // auth state should be updated\n          await this.authStateManager.updateAuthState();\n          throw e;\n        }\n      } else {\n        return; // nothing to do\n      }\n      \n      // ensure auth state has been updated\n      await this.authStateManager.updateAuthState();\n  \n      // clear originalUri from storage\n      this.removeOriginalUri(state);\n  \n      // Redirect to originalUri\n      const { restoreOriginalUri } = this.options;\n      if (restoreOriginalUri) {\n        await restoreOriginalUri(this, originalUri);\n      } else if (originalUri) {\n        window.location.replace(originalUri);\n      }\n    }\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}