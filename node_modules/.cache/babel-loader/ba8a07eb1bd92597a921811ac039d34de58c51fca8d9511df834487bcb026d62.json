{"ast":null,"code":"import _regeneratorRuntime from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _classCallCheck from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { __rest } from '../../../_virtual/_tslib.js';\nimport { Remediator } from '../Base/Remediator.js';\nimport { unwrapFormValue } from './util.js';\nvar GenericRemediator = /*#__PURE__*/function (_Remediator) {\n  _inherits(GenericRemediator, _Remediator);\n  var _super = _createSuper(GenericRemediator);\n  function GenericRemediator() {\n    _classCallCheck(this, GenericRemediator);\n    return _super.apply(this, arguments);\n  }\n  _createClass(GenericRemediator, [{\n    key: \"canRemediate\",\n    value: function canRemediate() {\n      if (typeof this.remediation.action !== 'function') {\n        return false;\n      }\n      if (this.remediation.name === 'poll' || this.remediation.name.endsWith('-poll')) {\n        return true;\n      }\n      if (this.options.step) {\n        return true;\n      }\n      return false;\n    }\n  }, {\n    key: \"getData\",\n    value: function getData() {\n      var _this = this;\n      var data = this.getInputs().reduce(function (acc, _ref) {\n        var name = _ref.name;\n        acc[name] = _this.values[name];\n        return acc;\n      }, {});\n      return data;\n    }\n  }, {\n    key: \"getNextStep\",\n    value: function getNextStep(authClient, _context) {\n      var name = this.getName();\n      var inputs = this.getInputs();\n      var _a = this.remediation,\n        href = _a.href,\n        method = _a.method,\n        rel = _a.rel,\n        accepts = _a.accepts,\n        produces = _a.produces,\n        value = _a.value,\n        action = _a.action,\n        rest = __rest(_a, [\"href\", \"method\", \"rel\", \"accepts\", \"produces\", \"value\", \"action\"]);\n      if (action) {\n        return Object.assign(Object.assign(Object.assign({}, rest), !!inputs.length && {\n          inputs: inputs\n        }), {\n          action: function () {\n            var _action = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(params) {\n              return _regeneratorRuntime().wrap(function _callee$(_context2) {\n                while (1) switch (_context2.prev = _context2.next) {\n                  case 0:\n                    return _context2.abrupt(\"return\", authClient.idx.proceed(Object.assign({\n                      step: name\n                    }, params)));\n                  case 1:\n                  case \"end\":\n                    return _context2.stop();\n                }\n              }, _callee);\n            }));\n            function action(_x) {\n              return _action.apply(this, arguments);\n            }\n            return action;\n          }()\n        });\n      }\n      return Object.assign({}, this.remediation);\n    }\n  }, {\n    key: \"getInputs\",\n    value: function getInputs() {\n      return (this.remediation.value || []).filter(function (_ref2) {\n        var name = _ref2.name;\n        return name !== 'stateHandle';\n      }).map(unwrapFormValue).map(function (input) {\n        input.type = input.type || 'string';\n        return input;\n      });\n    }\n  }]);\n  return GenericRemediator;\n}(Remediator);\nexport { GenericRemediator };","map":{"version":3,"names":["GenericRemediator","_Remediator","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","value","canRemediate","remediation","action","name","endsWith","options","step","getData","_this","data","getInputs","reduce","acc","_ref","values","getNextStep","authClient","_context","getName","inputs","_a","href","method","rel","accepts","produces","rest","__rest","Object","assign","length","_action","_asyncToGenerator","_regeneratorRuntime","mark","_callee","params","wrap","_callee$","_context2","prev","next","abrupt","idx","proceed","stop","_x","filter","_ref2","map","unwrapFormValue","input","type","Remediator"],"sources":["/Users/aadar00/Documents/image-moderation-app/frontend/node_modules/@okta/lib/idx/remediators/GenericRemediator/GenericRemediator.ts"],"sourcesContent":["import { OktaAuthIdxInterface, IdxContext, NextStep, Input } from '../../types';\nimport { Remediator } from '../Base/Remediator';\nimport { unwrapFormValue } from './util';\n\nexport class GenericRemediator extends Remediator {\n  canRemediate(): boolean {\n    // only handle remediations that are able to submit form (xhr)\n    if (typeof this.remediation.action !== 'function') {\n      return false;\n    }\n\n    // DO NOT REMOVE - bring it back when enable client side validation for GenericRemediator - OKTA-512003\n    // const inputs = this.getInputs();\n    // const res = inputs.reduce((acc, input) => {\n    //   return acc && hasValidInputValue(input, this.values);\n    // }, true);\n    // return res;\n\n    if (this.remediation.name === 'poll' || this.remediation.name.endsWith('-poll')) {\n      return true;\n    }\n\n    if (this.options.step) {\n      return true;\n    }\n    \n    // disable auto proceed for unknown remediations\n    return false;\n  }\n\n  getData() {\n    const data = this.getInputs().reduce((acc, { name }) => {\n      acc[name] = this.values[name];\n      return acc;\n    }, {});\n    return data;\n  }\n\n  getNextStep(authClient: OktaAuthIdxInterface, _context?: IdxContext): NextStep {\n    const name = this.getName();\n    const inputs = this.getInputs();\n    \n    /* eslint-disable no-unused-vars, @typescript-eslint/no-unused-vars */\n    // excludes transformed fields\n    const { \n      // http metas have been transformed to action\n      href, \n      method, \n      rel, \n      accepts, \n      produces, \n      // value has been transform to inputs\n      value,\n      // will be transformed to a function that resolves IdxTransaction\n      action,\n      ...rest \n    } = this.remediation;\n    /* eslint-enable no-unused-vars, @typescript-eslint/no-unused-vars */\n\n    // step to handle form submission\n    if (action) {\n      return { \n        ...rest,\n        ...(!!inputs.length && { inputs }),\n        action: async (params?) => {\n          return authClient.idx.proceed({\n            step: name,\n            ...params\n          });\n        }\n      };\n    }\n\n    // return whole remediation data for other steps, eg \"redirect-idp\"\n    return { ...this.remediation } as NextStep;\n    \n  }\n\n  getInputs(): Input[] {\n    return (this.remediation.value || [])\n      .filter(({ name }) => name !== 'stateHandle')\n      .map(unwrapFormValue)\n      .map(input => {\n        // use string as default input type\n        input.type = input.type || 'string';\n        return input;\n      });\n  }\n\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}